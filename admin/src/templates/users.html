<div mm-auth="can_configure">

  <legend translate>Users</legend>
  <div class="btn-toolbar">
    <a id="add-user" class="btn btn-primary" ng-click="editUser({})">
      <i class="fa fa-user"></i>
      <span>Add User</span>
    </a>
    <a id="add-users" class="btn btn-primary" ng-click="showAddMultipleUsersModal()"
       data-controls-modal="edit-users-bulk" data-backdrop="static" data-keyboard="false" href="#">
      <i class="fa fa-users"></i>
      <span translate>Add multiple</span>
    </a>
  </div>

  <div class="loader" ng-show="loading"></div>

  <div class="tab-content deletable" ng-hide="loading">

    <p ng-show="error" class="alert alert-danger" role="alert" translate>Error fetching users</p>
    <div class="container-fluid">
      <div class="row selection-heading" ng-hide="error">
        <div class="col-xs-2" translate>User Name</div>
        <div class="col-xs-2" translate>Full Name</div>
        <div class="col-xs-3" translate>configuration.role</div>
        <div class="col-xs-2" translate>Phone Number</div>
        <div class="col-xs-1" translate>Facility</div>
        <div class="col-xs-1" translate>Contact</div>
        <div class="col-xs-1"></div>
      </div>

      <div class="row selection" test-id="user-list" ng-repeat="user in users" ng-click="!user.inactive && editUser(user)" ng-class="{'inactive': user.inactive}" translate-attr="{'title': user.inactive ? 'Deleted user' : ''}">
        <div class="col-xs-2" test-id="username-list">{{user.name}}</div>
        <div class="col-xs-2">{{user.fullname}}</div>
        <div class="col-xs-3"><span ng-if="user.roles[0]" translate>{{(roles[user.roles[0]].name) || ('usertype.' + user.roles[0])}}</span></div>
        <div class="col-xs-2">{{user.phone}}</div>
        <div class="col-xs-1"><i class="fa fa-check" ng-if="user.facility_id"></i></div>
        <div class="col-xs-1"><i class="fa fa-check" ng-if="user.contact_id"></i></div>
        <div class="col-xs-1 delete">
          <a class="btn btn-sm btn-danger" ng-if="!user.inactive" ng-click="deleteUserPrepare(user, $event)"><i class="fa fa-trash-o"></i></a>
        </div>
      </div>
    </div>
  </div>

  <div ng-if="displayAddMultipleUsersModal">
    <mm-modal
            status="status"
            id="'edit-translation'"
            title-key="editing ? 'Edit translation' : 'translation.add'"
            submit-key="'Submit'"
            submitting-key="'Submitting'"
            on-cancel="cancel()"
            on-submit="submit()"
            on-delete="delete()"
            show-delete="isCustom"
    >
      <form action="" method="POST">
        <div class="form-group" ng-class="{ required: !editing }">
          <label translate>translation.key</label>
          <input class="form-control" ng-model="model.key" ng-disabled="editing">
          <span class="error" ng-if="errors.key">{{errors.key}}</span>
        </div>
        <div class="form-group" ng-repeat="locale in model.locales track by locale._id">
          <label>{{locale.name}}</label>
          <textarea class="form-control" ng-model="model.values[locale.code]"></textarea>
        </div>
      </form>
    </mm-modal>
<strong>holqqqqq</strong>
  </div>
</div>
